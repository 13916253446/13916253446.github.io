(window.webpackJsonp=window.webpackJsonp||[]).push([["ES6.async"],{IK5m:function(s,a,t){var n=t("o+BE");"string"==typeof n&&(n=[[s.i,n,""]]),n.locals&&(s.exports=n.locals);(0,t("SZ7m").default)("7cdddb7a",n,!0,{})},V35n:function(s,a,t){"use strict";t.r(a);var n=t("JFUb"),l=Object(n.a)(null,function(){var s=this;s.$createElement;s._self._c;return s._m(0)},[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("h1",[s._v("内部执行过程")]),s._v(" "),t("ul",[t("li",[t("p",[t("code",{pre:!0},[s._v("async")]),s._v("方法的"),t("code",{pre:!0},[s._v("promise")]),s._v("只要出现不是"),t("code",{pre:!0},[s._v("resolved")]),s._v("的状态，"),t("code",{pre:!0},[s._v("async")]),s._v("方法将直接返回，不再继续往下执行")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{class:"hljs language-javascript"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" "),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{attrs:{class:"hljs-title"}},[s._v("getTopNavList")]),s._v(" ("),t("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" promise = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n        reject("),t("span",{attrs:{class:"hljs-string"}},[s._v("'停止执行'")]),s._v(")\n    })\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" result = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" promise\n    "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 后面的代码逻辑将不再执行")]),s._v("\n    "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(result)\n}\n\ngetTopNavList()\n")])])]),s._v(" "),t("li",[t("p",[t("code",{pre:!0},[s._v("async")]),s._v("方法返回的永远是个"),t("code",{pre:!0},[s._v("promise")]),s._v("对象，如果方法内部出现错误，或者不是"),t("code",{pre:!0},[s._v("resolve")]),s._v("状态,返回的就是个"),t("code",{pre:!0},[s._v("reject")]),s._v("，如果没有发生错误，方法最终返回的是，"),t("code",{pre:!0},[s._v("await")]),s._v("等待的"),t("code",{pre:!0},[s._v("promise")]),s._v("以及后续所有的代码执行完毕的返回值，如果没有明确指定返回值，将返回一个"),t("code",{pre:!0},[s._v("resolve")]),s._v("状态包含"),t("code",{pre:!0},[s._v("undefined")]),s._v("的"),t("code",{pre:!0},[s._v("promise")])]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{class:"hljs language-javascript"}},[t("span",{attrs:{class:"hljs-comment"}},[s._v("// 情景1")]),s._v("\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" "),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{attrs:{class:"hljs-title"}},[s._v("getTopNavList")]),s._v(" ("),t("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" promise = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n     reject("),t("span",{attrs:{class:"hljs-string"}},[s._v("'停止执行'")]),s._v(")\n })\n "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" result = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" promise\n}\n\ngetTopNavList()\n    .catch("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("msg")]),s._v(" =>")]),s._v(" {\n        "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log(msg) "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 将执行到这里，打印“停止执行”")]),s._v("\n    })\n\n"),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 情景2")]),s._v("\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" "),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{attrs:{class:"hljs-title"}},[s._v("getTopNavList")]),s._v(" ("),t("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" promise = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n     resolve("),t("span",{attrs:{class:"hljs-string"}},[s._v("'继续执行'")]),s._v(")\n })\n "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" result = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" promise\n}\ngetTopNavList()\n .then("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("res")]),s._v(" =>")]),s._v(" {\n     consoleg.log(res) "),t("span",{attrs:{class:"hljs-comment"}},[s._v("//将执行到这里，打印“undefined”")]),s._v("\n }) \n \n"),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 情景3")]),s._v("\n"),t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" "),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),t("span",{attrs:{class:"hljs-title"}},[s._v("getTopNavList")]),s._v(" ("),t("span",{attrs:{class:"hljs-params"}}),s._v(") ")]),s._v("{\n "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" promise = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n     resolve("),t("span",{attrs:{class:"hljs-string"}},[s._v("'继续执行'")]),s._v(")\n })\n "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" result = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" promise\n "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" result\n}\ngetTopNavList()\n .then("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("res")]),s._v(" =>")]),s._v(" {\n     consoleg.log(res) "),t("span",{attrs:{class:"hljs-comment"}},[s._v("//将执行到这里，打印“继续执行”")]),s._v("\n })\n")])])])]),s._v(" "),t("h1",[s._v("针对多个异步，而且每个错误状态进行不同的处理")]),s._v(" "),t("p",[s._v("初级版： 每个 await 都写这么长，写着也不方便也不优雅")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{class:"hljs language-javascript"}},[s._v("("),t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" () => {\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fetchData = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" () => {\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n            setTimeout("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n                resolve("),t("span",{attrs:{class:"hljs-string"}},[s._v("'fetch data is me'")]),s._v(")\n            }, "),t("span",{attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(")\n        })\n    }\n\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" [err, data] = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" fetchData().then("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("data")]),s._v(" =>")]),s._v(" ["),t("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", data] ).catch("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("err")]),s._v(" =>")]),s._v(" [err, "),t("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("])\n    "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{attrs:{class:"hljs-string"}},[s._v("'err'")]),s._v(", err)\n    "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{attrs:{class:"hljs-string"}},[s._v("'data'")]),s._v(", data)\n})()\n")])]),s._v(" "),t("p",[s._v("最终版")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{class:"hljs language-javascript"}},[s._v("("),t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" () => {\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" fetchData = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("async")]),s._v(" () => {\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("Promise")]),s._v("("),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("resolve, reject")]),s._v(") =>")]),s._v(" {\n            setTimeout("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n                resolve("),t("span",{attrs:{class:"hljs-string"}},[s._v("'fetch data is me'")]),s._v(")\n            }, "),t("span",{attrs:{class:"hljs-number"}},[s._v("1000")]),s._v(")\n        })\n    }\n\n    "),t("span",{attrs:{class:"hljs-comment"}},[s._v("// 抽离成公共方法")]),s._v("\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" awaitWrap = "),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("promise")]),s._v(") =>")]),s._v(" {\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" promise\n            .then("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("data")]),s._v(" =>")]),s._v(" ["),t("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v(", data])\n            .catch("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("err")]),s._v(" =>")]),s._v(" [err, "),t("span",{attrs:{class:"hljs-literal"}},[s._v("null")]),s._v("])\n    }\n\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" [err, data] = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("await")]),s._v(" awaitWrap(fetchData())\n    "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{attrs:{class:"hljs-string"}},[s._v("'err'")]),s._v(", err)\n    "),t("span",{attrs:{class:"hljs-built_in"}},[s._v("console")]),s._v(".log("),t("span",{attrs:{class:"hljs-string"}},[s._v("'data'")]),s._v(", data)\n})()\n")])])])}],!1,null,null,null);a.default=l.exports},WlPZ:function(s,a,t){s.exports=t("V35n")},"XDF/":function(s,a,t){"use strict";t.r(a);var n=t("WlPZ"),l={name:"ES6Async",components:{md:t.n(n).a}},r=t("JFUb");var v=function(s){t("IK5m")},_=Object(r.a)(l,function(){var s=this.$createElement,a=this._self._c||s;return a("div",[a("md")],1)},[],!1,v,"data-v-522c8e20",null);a.default=_.exports},"o+BE":function(s,a,t){(s.exports=t("I1BE")(!1)).push([s.i,"",""])}}]);