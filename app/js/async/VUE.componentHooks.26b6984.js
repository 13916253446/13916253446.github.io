(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"/xmF":function(s,a,e){s.exports=e("ZnDu")},"6ERj":function(s,a,e){(s.exports=e("I1BE")(!1)).push([s.i,"",""])},"7IIG":function(s,a,e){"use strict";e.r(a);var t=e("/xmF"),n={name:"VUEComponentHooks",components:{md:e.n(t).a}},r=e("JFUb");var v=function(s){e("dhWv")},o=Object(r.a)(n,function(){var s=this.$createElement,a=this._self._c||s;return a("div",[a("md")],1)},[],!1,v,"data-v-2b5a03ec",null);a.default=o.exports},ZnDu:function(s,a,e){"use strict";e.r(a);var t=e("JFUb"),n=Object(t.a)(null,function(){var s=this;s.$createElement;s._self._c;return s._m(0)},[function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("section",[e("h3",{attrs:{id:"ru-he-jian-ting-zi-zu-jian-de-sheng-ming-zhou-qi-ni"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ru-he-jian-ting-zi-zu-jian-de-sheng-ming-zhou-qi-ni","aria-hidden":"true"}},[s._v("¶")]),s._v(" 如何监听子组件的生命周期呢？")]),s._v(" "),e("p",[s._v("有时候，需要知道子组件的生命周期，然后做一些事情")]),s._v(" "),e("h4",{attrs:{id:"1-tong-guo-zai-zi-zu-jian-sheng-ming-zhou-qi-li-mian-fen-fa-shi-jian"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#1-tong-guo-zai-zi-zu-jian-sheng-ming-zhou-qi-li-mian-fen-fa-shi-jian","aria-hidden":"true"}},[s._v("¶")]),s._v(" 1. 通过在子组件生命周期里面分发事件")]),s._v(" "),e("pre",{pre:!0},[e("code",{attrs:{class:"hljs language-javascript"}},[e("span",{attrs:{class:"hljs-comment"}},[s._v("// child.vue")]),s._v("\nmounted () {\n  "),e("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$emit("),e("span",{attrs:{class:"hljs-string"}},[s._v("'mounted'")]),s._v(")\n}\n")])]),s._v(" "),e("h4",{attrs:{id:"2-bu-huo-vue-nei-bu-fen-fa-de-shi-jian"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#2-bu-huo-vue-nei-bu-fen-fa-de-shi-jian","aria-hidden":"true"}},[s._v("¶")]),s._v(" 2. 捕获"),e("code",{pre:!0},[s._v("vue")]),s._v("内部分发的事件")]),s._v(" "),e("p",[s._v("通过"),e("code",{pre:!0},[s._v("@hooks:生命周期")]),s._v("来实现监听")]),s._v(" "),e("pre",{pre:!0},[e("code",{attrs:{class:"hljs language-HTML"}},[e("span",{attrs:{class:"hljs-tag"}},[s._v("<"),e("span",{attrs:{class:"hljs-name"}},[s._v("child")]),s._v(" "),e("span",{attrs:{class:"hljs-attr"}},[s._v("@hooks:mounted")]),s._v("="),e("span",{attrs:{class:"hljs-string"}},[s._v('"mounted"')]),s._v(">")]),e("span",{attrs:{class:"hljs-tag"}},[s._v("</"),e("span",{attrs:{class:"hljs-name"}},[s._v("child")]),s._v(">")]),s._v("\n")])]),s._v(" "),e("h3",{attrs:{id:"fen-xi-vue-sheng-ming-zhou-qi-de-yuan-ma"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#fen-xi-vue-sheng-ming-zhou-qi-de-yuan-ma","aria-hidden":"true"}},[s._v("¶")]),s._v(" 分析"),e("code",{pre:!0},[s._v("Vue")]),s._v("生命周期的源码")]),s._v(" "),e("p",[s._v("在 "),e("code",{pre:!0},[s._v("_init")]),s._v("方法中执行的，它的定义在"),e("code",{pre:!0},[s._v("src/core/instance/init.js")]),s._v("中：")]),s._v(" "),e("pre",{pre:!0},[e("code",{attrs:{class:"hljs language-javascript"}},[s._v("Vue.prototype._init = "),e("span",{attrs:{class:"hljs-function"}},[e("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" ("),e("span",{attrs:{class:"hljs-params"}},[s._v("options?: Object")]),s._v(") ")]),s._v("{\n  "),e("span",{attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n  initLifecycle(vm)\n  initEvents(vm)\n  initRender(vm)\n  callHook(vm, "),e("span",{attrs:{class:"hljs-string"}},[s._v("'beforeCreate'")]),s._v(")\n  initInjections(vm) "),e("span",{attrs:{class:"hljs-comment"}},[s._v("// resolve injections before data/props")]),s._v("\n  initState(vm)\n  initProvide(vm) "),e("span",{attrs:{class:"hljs-comment"}},[s._v("// resolve provide after data/props")]),s._v("\n  callHook(vm, "),e("span",{attrs:{class:"hljs-string"}},[s._v("'created'")]),s._v(")\n  "),e("span",{attrs:{class:"hljs-comment"}},[s._v("// ...")]),s._v("\n}\n")])]),s._v(" "),e("p",[s._v("源码中最终执行生命周期的函数都是调用"),e("code",{pre:!0},[s._v("callHook")]),s._v("方法，它的定义在"),e("code",{pre:!0},[s._v("src/core/instance/lifecycle")]),s._v("中：")]),s._v(" "),e("pre",{pre:!0},[e("code",{attrs:{class:"hljs language-javascript"}},[e("span",{attrs:{class:"hljs-keyword"}},[s._v("export")]),s._v(" "),e("span",{attrs:{class:"hljs-function"}},[e("span",{attrs:{class:"hljs-keyword"}},[s._v("function")]),s._v(" "),e("span",{attrs:{class:"hljs-title"}},[s._v("callHook")]),s._v(" ("),e("span",{attrs:{class:"hljs-params"}},[s._v("vm: Component, hook: string")]),s._v(") ")]),s._v("{\n  pushTarget()\n  "),e("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" handlers = vm.$options[hook]\n  "),e("span",{attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (handlers) {\n    "),e("span",{attrs:{class:"hljs-keyword"}},[s._v("for")]),s._v(" ("),e("span",{attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" i = "),e("span",{attrs:{class:"hljs-number"}},[s._v("0")]),s._v(", j = handlers.length; i < j; i++) {\n      "),e("span",{attrs:{class:"hljs-keyword"}},[s._v("try")]),s._v(" {\n        handlers[i].call(vm)\n      } "),e("span",{attrs:{class:"hljs-keyword"}},[s._v("catch")]),s._v(" (e) {\n        handleError(e, vm, "),e("span",{attrs:{class:"hljs-string"}},[s._v("`"),e("span",{attrs:{class:"hljs-subst"}},[s._v("${hook}")]),s._v(" hook`")]),s._v(")\n      }\n    }\n  }\n  "),e("span",{attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (vm._hasHookEvent) {\n    vm.$emit("),e("span",{attrs:{class:"hljs-string"}},[s._v("'hook:'")]),s._v(" + hook)\n  }\n  popTarget()\n}\n")])]),s._v(" "),e("p",[s._v("可以看到在调用生命周期的时候，除了调用以外，还会"),e("code",{pre:!0},[s._v("$emit")]),s._v("一个"),e("code",{pre:!0},[s._v("hooks:生命周期")]),s._v("事件")]),s._v(" "),e("p",[s._v("可以看到"),e("code",{pre:!0},[s._v("beforeCreate")]),s._v("和"),e("code",{pre:!0},[s._v("created")]),s._v("的钩子调用是在 "),e("code",{pre:!0},[s._v("initState")]),s._v("的前后，"),e("code",{pre:!0},[s._v("initState")]),s._v("的作用是初始化"),e("code",{pre:!0},[s._v("props")]),s._v("、"),e("code",{pre:!0},[s._v("data")]),s._v("、"),e("code",{pre:!0},[s._v("methods")]),s._v("、"),e("code",{pre:!0},[s._v("watch")]),s._v("、"),e("code",{pre:!0},[s._v("computed")]),s._v("等属性，之后我们会详细分析。那么显然"),e("code",{pre:!0},[s._v("beforeCreate")]),s._v("的钩子函数中就不能获取到"),e("code",{pre:!0},[s._v("props")]),s._v("、"),e("code",{pre:!0},[s._v("data")]),s._v("中定义的值，也不能调用"),e("code",{pre:!0},[s._v("methods")]),s._v("中定义的函数。")]),s._v(" "),e("p",[s._v("在这俩个钩子函数执行的时候，并没有渲染"),e("code",{pre:!0},[s._v("DOM")]),s._v("，所以我们也不能够访问"),e("code",{pre:!0},[s._v("DOM")]),s._v("，一般来说，如果组件在加载的时候需要和后端有交互，放在这俩个钩子函数执行都可以，如果是需要访问"),e("code",{pre:!0},[s._v("props")]),s._v("、"),e("code",{pre:!0},[s._v("data")]),s._v("等数据的话，就需要使用"),e("code",{pre:!0},[s._v("created")]),s._v("钩子函数。")])])}],!1,null,null,null);a.default=n.exports},dhWv:function(s,a,e){var t=e("6ERj");"string"==typeof t&&(t=[[s.i,t,""]]),t.locals&&(s.exports=t.locals);(0,e("SZ7m").default)("201bcc89",t,!0,{})}}]);