(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{"C+ET":function(s,a,t){(s.exports=t("I1BE")(!1)).push([s.i,"",""])},ElNA:function(s,a,t){var n=t("C+ET");"string"==typeof n&&(n=[[s.i,n,""]]),n.locals&&(s.exports=n.locals);(0,t("SZ7m").default)("76641df4",n,!0,{})},FpP7:function(s,a,t){"use strict";t.r(a);var n=t("zBdr"),e={name:"VUEAbstract",components:{md:t.n(n).a}},r=t("JFUb");var l=function(s){t("ElNA")},v=Object(r.a)(e,function(){var s=this.$createElement,a=this._self._c||s;return a("div",[a("md")],1)},[],!1,l,"data-v-1cf86564",null);a.default=v.exports},"ol/l":function(s,a,t){"use strict";t.r(a);var n=t("JFUb"),e=Object(n.a)(null,function(){var s=this;s.$createElement;s._self._c;return s._m(0)},[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("section",[t("h1",[s._v("创建高级组件：抽象组件")]),s._v(" "),t("p",[s._v("我们常用的"),t("code",{pre:!0},[s._v("transition")]),s._v("和"),t("code",{pre:!0},[s._v("keep-alive")]),s._v("就是一个抽象组件。抽象组件是无状态的，同样也是“不存在的”，它自己并不会被渲染为实际的DOM，而是直接返回以及操作它的子元素。")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("把函数防抖/函数节流包装成通用组件")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("在"),t("code",{pre:!0},[s._v("render")]),s._v("函数中，组件修改子VNode的事件，再将其返回回去。")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{class:"hljs language-javascript"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" debounce = "),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("func, time, ctx")]),s._v(") =>")]),s._v(" {\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("let")]),s._v(" timer\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" rtn = "),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("...params")]),s._v(") =>")]),s._v(" {\n        clearTimeout(timer)\n        timer = setTimeout("),t("span",{attrs:{class:"hljs-function"}},[t("span",{attrs:{class:"hljs-params"}},[s._v("()")]),s._v(" =>")]),s._v(" {\n            func.apply(ctx, params)\n        }, time)\n    }\n    "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" rtn\n}\n\nVue.component("),t("span",{attrs:{class:"hljs-string"}},[s._v("'Debounce'")]),s._v(", {\n    "),t("span",{attrs:{class:"hljs-attr"}},[s._v("abstract")]),s._v(": "),t("span",{attrs:{class:"hljs-literal"}},[s._v("true")]),s._v(",\n    "),t("span",{attrs:{class:"hljs-attr"}},[s._v("props")]),s._v(": ["),t("span",{attrs:{class:"hljs-string"}},[s._v("'time'")]),s._v(", "),t("span",{attrs:{class:"hljs-string"}},[s._v("'events'")]),s._v("],\n    created () {\n      "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".eventKeys = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".events.split("),t("span",{attrs:{class:"hljs-string"}},[s._v("','")]),s._v(")\n      "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".originMap = {}\n      "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".debouncedMap = {}\n    },\n    render() {\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" vnode = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".$slots.default["),t("span",{attrs:{class:"hljs-number"}},[s._v("0")]),s._v("]\n\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".eventKeys.forEach("),t("span",{attrs:{class:"hljs-function"}},[s._v("("),t("span",{attrs:{class:"hljs-params"}},[s._v("key")]),s._v(") =>")]),s._v(" {\n            "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" target = vnode.data.on[key]\n            "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (target === "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".originMap[key] && "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".debouncedMap[key]) {\n                vnode.data.on[key] = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".debouncedMap[key]\n            } "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("else")]),s._v(" "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("if")]),s._v(" (target) {\n                "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".originMap[key] = target\n                "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".debouncedMap[key] = debounce(target, "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".time, vnode)\n                vnode.data.on[key] = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".debouncedMap[key]\n            }\n        })\n        \n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" vnode\n    },\n})\n")])])])])])]),s._v(" "),t("p",[s._v("使用：")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{class:"hljs language-javascript"}},[t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" app = "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("new")]),s._v(" Vue({\n    "),t("span",{attrs:{class:"hljs-attr"}},[s._v("el")]),s._v(": "),t("span",{attrs:{class:"hljs-string"}},[s._v("'#app'")]),s._v(",\n    data () {\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("return")]),s._v(" {\n            "),t("span",{attrs:{class:"hljs-attr"}},[s._v("val")]),s._v(": "),t("span",{attrs:{class:"hljs-number"}},[s._v("0")]),s._v(",\n        }\n    },\n    "),t("span",{attrs:{class:"hljs-attr"}},[s._v("methods")]),s._v(": {\n        onClick ($ev, val) {\n            "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".val += val\n        },\n        onAdd () {\n            "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("this")]),s._v(".val += "),t("span",{attrs:{class:"hljs-number"}},[s._v("3")]),s._v("\n        }\n    }\n})\n")])]),s._v(" "),t("h2",{attrs:{id:"he-shi-yong-zhi-ling-bi-jiao"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#he-shi-yong-zhi-ling-bi-jiao","aria-hidden":"true"}},[s._v("¶")]),s._v(" 和使用指令比较")]),s._v(" "),t("p",[s._v("使用自定义指令也是一种思路，不过指令的bind发生在"),t("code",{pre:!0},[s._v("created")]),s._v("的回调中，也就是晚于事件的初始化的，这样的话就不能通过修改"),t("code",{pre:!0},[s._v("vnode.data.on")]),s._v("来改变绑定的事件回调，只能自己来绑定事件了：")]),s._v(" "),t("pre",{pre:!0},[t("code",{attrs:{class:"hljs language-javascript"}},[s._v("Vue.directive("),t("span",{attrs:{class:"hljs-string"}},[s._v("'debounce'")]),s._v(", {\n    bind (el, { value }, vnode) {\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" [target, time] = value\n        "),t("span",{attrs:{class:"hljs-keyword"}},[s._v("const")]),s._v(" debounced = debounce(target, time, vnode)\n        el.addEventListener("),t("span",{attrs:{class:"hljs-string"}},[s._v("'click'")]),s._v(", debounced)\n        el._debounced = debounced\n    },\n    destroy (el) {\n        el.removeEventListener("),t("span",{attrs:{class:"hljs-string"}},[s._v("'click'")]),s._v(", el._debounced)\n    }\n})\n")])])])}],!1,null,null,null);a.default=e.exports},zBdr:function(s,a,t){s.exports=t("ol/l")}}]);